{
  "meta": {
    "project": "Gestão de Pedidos (Cristal Brindes)",
    "date": "2026-02-15",
    "prepared_by": "Generated by TestSprite"
  },
  "product_overview": "Aplicação web para centralizar e automatizar o fluxo de vendas de brindes corporativos, cobrindo orçamentos, pedidos, financeiro e comissões com painel de gestão e controle de produção.",
  "core_goals": [
    "Centralizar dados de clientes, fornecedores, produtos e pedidos em um único sistema",
    "Automatizar cálculos financeiros (custos, margens, impostos e comissões)",
    "Controlar o fluxo de status dos pedidos desde orçamento até finalização",
    "Reduzir erros por validação de dados e auditoria de alterações",
    "Fornecer dashboards e KPIs para vendedores e gerência",
    "Garantir segurança e acesso via Supabase Auth com Row Level Security"
  ],
  "features": [
    {
      "name": "User Authentication",
      "description": "Login via Supabase Auth para permitir acesso seguro ao sistema e redirecionar usuários autenticados ao dashboard.",
      "user_flows": [
        "Navigate to /login -> Enter email and password -> Click Login -> Redirect to /",
        "Navigate to /login -> Enter email and password with incorrect credentials -> Click Login -> See error message 'Invalid credentials'"
      ]
    },
    {
      "name": "Order Management",
      "description": "Criar, visualizar e gerenciar pedidos; incluir itens, prazos, custos previstos e confirmar pagamentos para calcular comissões.",
      "user_flows": [
        "Navigate to / -> View list of orders -> Click 'New Order' to create -> Navigate to /pedido/novo -> Fill order details (client, products, values) -> Save order -> See new order in list",
        "Navigate to /pedido/novo -> Fill order details missing required client -> Click Save -> See validation error indicating required client field",
        "Navigate to / -> View list of orders -> Use Filter orders by status -> See filtered results",
        "Navigate to /pedido/novo -> Fill order details -> Click Save -> See error 'Failed to save order' (server error)"
      ]
    },
    {
      "name": "CRM & Financial Dashboard",
      "description": "Visão integrada de leads (Kanban), performance de vendas e estatísticas financeiras com filtros por data e vendedor.",
      "user_flows": [
        "Navigate to /crm -> View sales performance charts -> Filter financial data by date/salesperson -> See updated charts",
        "Navigate to /crm -> Drag and drop leads in Kanban -> See lead status updated",
        "Navigate to /crm -> Select invalid date range in financial filter -> Click Apply -> See validation error for date range",
        "Navigate to /crm -> Drag and drop lead -> System fails to persist change -> See error 'Update failed'"
      ]
    },
    {
      "name": "Budgets / Quotes (Orçamentos)",
      "description": "Listagem e consulta de orçamentos/quotes para converter em pedidos ou acompanhar negociações.",
      "user_flows": [
        "Navigate to /orcamentos -> View list of budgets -> Click a budget item -> See budget details",
        "Navigate to /orcamentos -> Apply filter that returns no results -> See 'No budgets found' message"
      ]
    },
    {
      "name": "Receivables Management (Contas a Receber)",
      "description": "Gerenciar entradas, confirmar pagamentos e atualizar status financeiro de pedidos e contas a receber.",
      "user_flows": [
        "Navigate to /receivables -> View list of receivables -> Click a receivable -> Open receivable details -> Mark as paid -> See status updated to PAID",
        "Navigate to /receivables -> Click a receivable -> Mark as paid -> Confirm in modal -> Payment processing fails -> See error 'Payment confirmation failed'"
      ]
    },
    {
      "name": "Payables Management (Contas a Pagar)",
      "description": "Registrar e acompanhar obrigações financeiras da empresa, controlando vencimentos e status de pagamento.",
      "user_flows": [
        "Navigate to /payables -> View list of payables -> Click payable item -> See payable details",
        "Navigate to /payables -> Attempt to mark payable as paid -> Confirm payment -> See error 'Payment update failed' on server error"
      ]
    },
    {
      "name": "Partners Management (Clientes / Fornecedores)",
      "description": "Cadastro e manutenção de parceiros com classificação CLIENTE ou FORNECEDOR e dados de contato financeiro.",
      "user_flows": [
        "Navigate to / -> Click Partners menu -> Click 'New Partner' -> Fill partner details (Name, Document, Contact, Email Financeiro) -> Save -> See partner in list",
        "Navigate to / -> Click Partners menu -> Click 'New Partner' -> Fill invalid CPF/CNPJ -> Click Save -> See validation error 'Invalid CPF/CNPJ'"
      ]
    },
    {
      "name": "Product Catalog",
      "description": "Manter catálogo base de produtos/brindes com atributos e preço unitário para uso em orçamentos e pedidos.",
      "user_flows": [
        "Navigate to / -> Click Products menu -> Click 'New Product' -> Fill product attributes (Name, Description, Price Unit) -> Save -> See product in catalog",
        "Navigate to / -> Click Products menu -> Click 'New Product' -> Fill duplicate product name -> Click Save -> See validation error 'Product already exists'"
      ]
    },
    {
      "name": "Commissions System",
      "description": "Geração automática de registros de comissão baseada em regras de negócio ao confirmar entradas e pagamentos restantes.",
      "user_flows": [
        "Navigate to / -> Open an order -> Confirm entry payment -> System generates commission record with status PENDING (1% of order total) -> See commission record linked to order",
        "Navigate to / -> Open an order -> Confirm remaining payment -> System generates commission record with status PENDING (1% of order total) -> See commission record linked to order",
        "Navigate to / -> Open an order -> Confirm entry payment -> System fails to create commission -> See alert 'Commission generation failed'"
      ]
    },
    {
      "name": "Calculation Factors (Configurações)",
      "description": "Gerenciar fatores padrão de cálculo (imposto, margem, contingência) que influenciam a precificação automática em orçamentos e pedidos.",
      "user_flows": [
        "Navigate to / -> Click Settings -> Open Calculation Factors -> Update tax rate -> Save -> See confirmation 'Factors updated' and new default applied in price calculation",
        "Navigate to / -> Click Settings -> Open Calculation Factors -> Enter invalid margin value -> Click Save -> See validation error for margin value"
      ]
    },
    {
      "name": "Audit Logs",
      "description": "Registrar automaticamente alterações críticas nos pedidos (status, valores) e possibilitar visualização dos logs de auditoria.",
      "user_flows": [
        "Navigate to / -> Open an order -> Change order status -> Save -> System writes an entry to order_logs -> Open order logs -> See new log entry describing the change",
        "Navigate to / -> Open an order -> Open order logs -> System fails to load logs -> See error 'Failed to load logs'"
      ]
    }
  ],
  "code_summary": {
    "version": "2",
    "type": "frontend",
    "tech_stack": [
      "TypeScript",
      "React",
      "Vite",
      "TailwindCSS",
      "Supabase"
    ],
    "routes": [
      {
        "path": "/login",
        "file": "pages/LoginPage.tsx",
        "auth_required": false,
        "description": "User login page with email/password"
      },
      {
        "path": "/",
        "file": "pages/OrderList.tsx",
        "auth_required": true,
        "description": "Dashboard and list of orders"
      },
      {
        "path": "/pedido/novo",
        "file": "pages/OrderForm.tsx",
        "auth_required": true,
        "description": "Create a new order"
      },
      {
        "path": "/crm",
        "file": "pages/ManagementPage.tsx",
        "auth_required": true,
        "description": "CRM, Performance stats and Financial overview"
      },
      {
        "path": "/orcamentos",
        "file": "pages/BudgetList.tsx",
        "auth_required": true,
        "description": "List of budgets/quotes"
      },
      {
        "path": "/receivables",
        "file": "pages/ReceivablesPage.tsx",
        "auth_required": true,
        "description": "Accounts receivable management"
      },
      {
        "path": "/payables",
        "file": "pages/PayablesPage.tsx",
        "auth_required": true,
        "description": "Accounts payable management"
      }
    ],
    "features": [
      {
        "name": "User Authentication",
        "description": "Login system using Supabase Auth or custom auth context",
        "files": [
          "pages/LoginPage.tsx",
          "lib/auth.tsx"
        ],
        "entry_route": "/login",
        "user_interactions": [
          "Enter email and password",
          "Click Login",
          "Redirect to Dashboard upon success"
        ],
        "auth_required": false
      },
      {
        "name": "Order Management",
        "description": "Create, view, and manage customer orders",
        "files": [
          "pages/OrderList.tsx",
          "pages/OrderForm.tsx"
        ],
        "entry_route": "/",
        "user_interactions": [
          "View list of orders",
          "Filter orders by status",
          "Click 'New Order' to create",
          "Fill order details (client, products, values)",
          "Save order"
        ],
        "auth_required": true
      },
      {
        "name": "CRM & Financial Dashboard",
        "description": "Integrated view for Leads (Kanban), Performance charts, and Financial stats",
        "files": [
          "pages/ManagementPage.tsx"
        ],
        "entry_route": "/crm",
        "user_interactions": [
          "Drag and drop leads in Kanban",
          "View sales performance charts",
          "Filter financial data by date/salesperson"
        ],
        "auth_required": true
      }
    ],
    "known_limitations": []
  }
}
